<!DOCTYPE html>
<html>
    <head>
        <title>Kicks Watch</title>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

        <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" 
        rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" 
        crossorigin="anonymous"> -->
    </head>

    <body style="background-color: black;">

        <nav class="navbar">
              <h1 style="text-align: center; color: rgb(255, 123, 123); margin-left: 10px;">Kicks Watch</h1>
        </nav>

        <div class="container">
            <h6 style="text-align: center; color: white;;">Welcome to Kicks Watch! The website that lists upcoming shoe releases along with their retail and resale price so that you can know which upcoming shoes you can make money from!</h6>
        </div>

        <div class="container">
            <div class="form-row">
                <div class="col-md-4 mb-3">
                    <label for="month" class="form-label" style="color: rgb(255, 123, 123);">Month: </label>
                    <select id="month" class="form-control" onchange="getDrops(value)">
                        <option value="January" selected="selected">January</option>
                        <option value="February">February</option>
                        <option value="March">March</option>
                        <option value="April">April</option>
                        <option value="May">May</option>
                        <option value="June">June</option>
                        <option value="July">July</option>
                        <option value="August">August</option>
                        <option value="September">September</option>
                        <option value="October">October</option>
                        <option value="November">November</option>
                        <option value="Decemeber">December</option>
                    </select>
                </div>

                <div class="col-md-4 mb-3">
                    <label for="sort" class="form-label" style="color: rgb(255, 123, 123);">Sort By: </label>
                    <select id="sort" class="form-control">
                        <option value="date" selected="selected">Release Date</option>
                        <option value="retail">Price: Retail</option>
                        <option value="resale">Price: Resale</option>
                        <option value="profit">Profit</option>
                    </select>
                </div>

                <div class="col-md-4 mb-3" style="margin-bottom: 0px;">
                    <button id="update" class="btn btn-primary" onclick="update()" style="text-align: right">Update</button>
                </div>
                
            </div>
            
            <table class="table table-hover table-dark" style="text-align: center; overflow: scroll;" id="shoelist">
            </table>
            
        </div>
        
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"
         integrity="sha384-q2kxQ16AaE6UbzuKqyBE9/u/KzioAlnx2maXQHiDX9d4/zp8Ok3f+M7DPm+Ib6IU" 
         crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.min.js" 
        integrity="sha384-pQQkAEnwaBkjpqZ8RU1fF1AKtTcHJwFl3pblpTlHXybJjHpMYo79HY3hIi4NKxyj" 
        crossorigin="anonymous"></script>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

        <script>

            'use strict';

            let request = null;

            function getDrops(month){
                month = encodeURIComponent(month);

                let url = '/getDrops?month=' + month

                if (request != null){
                    request.abort();
                }

                $('#shoelist').html("<div id='loading'><h3 style='color: rgb(255, 123, 123); text-align: center;'>Please Wait...</h3><img src='static/ajax-loader.gif'></div>");

                request = $.ajax(
                    {
                        type: 'GET',
                        url: url,
                        success: handleResponse
                    }
                );
            }

            function handleResponse(response){
                $('#shoelist').html(response);
            }

            function handleResponse2(response){
                $('#shoelist').html(response);
            }

            function update(){
                let month = $('#month').val();
                month = encodeURIComponent(month);

                let url = '/updateDrops?month=' + month

                if (request != null){
                    request.abort();
                }

                $('#shoelist').html("<div id='loading'><h3 style='color: rgb(255, 123, 123); text-align: center;'>Please Wait...</h3><img src='static/ajax-loader.gif'></div>");

                request = $.ajax(
                    {
                        type: 'GET',
                        url: url,
                        success: handleResponse2
                    }
                );
            }

            function setup(){
                getDrops($('#month').val());
            }

            $('document').ready(setup);
        </script>        
    </body>
</html>

